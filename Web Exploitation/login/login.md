# login

## Overview

Author: BrownieInMotion

Category: Web  Exploitation

100 points

## Description

My dog-sitter's brother made this website but I can't get in; can you help?

[login.mars.picoctf.net](https://login.mars.picoctf.net/)

## Approach

Like any web challenge, the first thing to do is to inspect the site. Ctrl + shift + I:

```html
<html><head>
        <link rel="stylesheet" href="styles.css">
        <script src="index.js"></script>
    </head>
    <body>
        <div>
          <h1>Login</h1>
          <form method="POST">
            <label for="username">Username</label>
            <input name="username" type="text">
            <label for="username">Password</label>
            <input name="password" type="password">
            <input type="submit" value="Submit">
          </form>
        </div>
    

</body></html>
```

This line `<script src="index.js"></script>` is important since it shows where the JavaScript of the site is located.

[https://login.mars.picoctf.net/index.js](https://login.mars.picoctf.net/index.js) shows

```js
(async()=>{await new Promise((e=>window.addEventListener("load",e))),document.querySelector("form").addEventListener("submit",(e=>{e.preventDefault();const r={u:"input[name=username]",p:"input[name=password]"},t={};for(const e in r)t[e]=btoa(document.querySelector(r[e]).value).replace(/=/g,"");return"YWRtaW4"!==t.u?alert("Incorrect Username"):"cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ"!==t.p?alert("Incorrect Password"):void alert(`Correct Password! Your flag is ${atob(t.p)}.`)}))})();
```

Notice `return"YWRtaW4"!==t.u?alert("Incorrect Username"):"cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ"!==t.p?alert("Incorrect Password")` which suggests the username is `YWRtaW4` and the password is `cGljb0NURns1M3J2M3JfNTNydjNyXzUzcnYzcl81M3J2M3JfNTNydjNyfQ`.

These values are encoded in [base64](https://en.wikipedia.org/wiki/Base64) which we can decrypt [here](https://www.base64decode.org/).

Username is `admin` and password is `picoCTF{53rv3r_53rv3r_53rv3r_53rv3r_53rv3r}`. Input these into the login and an alert will come up displaying the flag.

## Flag

picoCTF{53rv3r_53rv3r_53rv3r_53rv3r_53rv3r}
